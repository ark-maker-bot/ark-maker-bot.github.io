<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="musicplayer.css">
  <meta name="description" content="A cute and clean music player which uses music from upbeat.pw">
  <meta name="keywords" content="cat, clean, yin&yang, yinandyang, cute, musicplayer">
  <link rel="shortcut icon" href="../images/day_retro_cassette_icon_131180.ico" type="image/x-icon">
  <title>Music Player</title>
</head>
<body class="light">
  <!-- Loads Saved Theme From Local Storage -->
  <script>
    $(document).ready(function () {
      const currentTheme = localStorage.getItem("theme"), curTextTheme = localStorage.getItem("themeText"), curTextTheme2 = localStorage.getItem("themeText2");
      if(currentTheme === "dark" && curTextTheme === 'dark' && curTextTheme2 === 'dark'){ $("#changeThemeBox").trigger('click'); } // document.body.classList.toggle("dark");
    });

    let songTitle = axios.get('https://upbeatradio.net/api/v1/stats').then(res => { 
      const data = res.data, title = data.song.title;
      return title;
    });
    songTitle.then(title => document.getElementById("playing").innerHTML = `Currently Playing: ${title}`);
    setInterval(() => {
      songTitle = axios.get('https://upbeatradio.net/api/v1/stats').then(res => { const data = res.data, title = data.song.title; return title; });
      songTitle.then(title => document.getElementById("playing").innerHTML = `Currently Playing: ${title}`);
    }, 5000);
  </script>

  <!-- NavBar -->
  <section>
    <nav role="navigation">
      <div id="menuToggle">
        <input type="checkbox" />
        <span></span>
        <span></span>
        <span></span>
        <ul id="menu">
          <a href="../"><li>Home</li></a>
          <a href="#"><li>Music</li></a>
          <li>Theme: <label class="switch" for="checkbox" id="changeThemeBox"><input type="checkbox" id="checkbox" onclick="changeTheme(this)" /><div class="slider round"></div></label></li>
        </ul>
      </div>
    </nav>
  </section>

  <!-- Music Player -->
  <section class="main">
    <div id="text"><p id="playing">Currently Playing: </p></div>
    <div class="wrapper">
      <div class="polka-dot"></div>
      <div class="player-wrapper">
        <div class="player-container">
          <div class="player">
            <div class="cassete">
              <div class="rotator-container">
                <div class="cog left-cog">
                  <div class="chil1"></div>
                  <div class="chil2"></div>
                  <div class="cog-img"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                      <path d="M23.9,13l4.1-2.3l-4.1-7.1l-4.1,2.3l-1.6-0.8V0.3H9.9v4.8L8.2,5.9L4.1,3.6L0,10.7L4.1,13V15L0,17.3l4.1,7.1l4.1-2.3l1.6,1
	v4.7h8.2v-4.7l1.6-1l4.1,2.3l4.1-7.1L23.9,15C23.9,15,23.9,13,23.9,13z M14,16.7c-1.5,0-2.6-1.2-2.6-2.6c0-1.5,1.2-2.6,2.6-2.6
	s2.6,1.2,2.6,2.6S15.5,16.7,14,16.7z" />
                    </svg></div>
                </div>

                <div class="cog right-cog">
                  <div class="chil1"></div>
                  <div class="chil2"></div>
                  <div class="cog-img"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                      <path d="M23.9,13l4.1-2.3l-4.1-7.1l-4.1,2.3l-1.6-0.8V0.3H9.9v4.8L8.2,5.9L4.1,3.6L0,10.7L4.1,13V15L0,17.3l4.1,7.1l4.1-2.3l1.6,1
	v4.7h8.2v-4.7l1.6-1l4.1,2.3l4.1-7.1L23.9,15C23.9,15,23.9,13,23.9,13z M14,16.7c-1.5,0-2.6-1.2-2.6-2.6c0-1.5,1.2-2.6,2.6-2.6
	s2.6,1.2,2.6,2.6S15.5,16.7,14,16.7z" />
                    </svg></div>
                </div>
              </div>
            </div>
          </div>
          <div class="screws one"></div>
          <div class="screws two"></div>
          <div class="screws three"></div>
          <div class="screws four"></div>
          <div class="base">
            <div class="bottom-base"></div>
          </div>
        </div>
      </div>
      <div class="controls-container">
        <button class="btn play" onclick="bgmPlay()"></button>
        <button class="btn"></button>
        <button onclick="bgmStop()" class="btn"></button>
        <button class="btn"></button>
      </div>
    </div>
  </section>
  <audio id='player_audio' src='https://live.upbeat.pw/' type="audio/mp3"></audio>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/js/all.min.js"></script>
  <script>
    let bgm = document.getElementById("player_audio");
    function bgmPlay() {
      bgm.play();
      bgm.volume = 0.2;
      $(".play").addClass("active");
      $(".cog-img").addClass("rotating");
      $(".stop").removeClass("active");
    }
    function bgmStop() {
      bgm.pause();
      bgm.currentTime = 0;
      $(".play").removeClass("active");
      $(".stop").addClass("active");
      $(".cog-img").removeClass("rotating");
    }

    function changeTheme(){
      document.body.classList.toggle("dark");
      let theme = "light";
      if(document.body.classList.contains("dark"))theme = "dark";
      localStorage.setItem("theme", theme);
      
      // Changes Text Theme
      document.getElementById("text").classList.toggle("dark");
      let themeText = "light";
      if(document.getElementById("text").classList.contains("dark"))themeText = "dark";
      localStorage.setItem("themeText", themeText);
    }
  </script>
</body>
</html>
